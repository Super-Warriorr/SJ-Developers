<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Car-Driving-2D</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0,height=device-height">
<style>
body {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    background-color: #333;
    font-family: 'Inter', sans-serif;
}

#openworld{
    height: 90vh;
    width: 50vh;
    background-color: lightgreen;
    position: relative;
    overflow: hidden;
    border: 5px solid gray;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
}

#car {
    background-color: red;
    height: 80px;
    width: 40px;
    position: absolute;
    bottom: 150px;
    border-left: 2px solid black;
    border-right: 2px solid black;
    border-radius: 5px;
    z-index: 2;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    padding: 5px 0;
    box-sizing: border-box;
    /* ADD THIS LINE FOR SMOOTH MOVEMENT */
    transition: left 0.1s linear; /* Adjust duration and easing as needed */
}

/* Common styles for car parts */
.car-window {
    width: 80%;
    height: 20px;
    background-color: skyblue;
    border: 1px solid #333;
    border-radius: 2px;
}

.car-roof { /* Not directly used in current HTML, but good to have if needed */
    width: 90%;
    height: 10px;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 2px;
}

.car-body-section {
    width: 90%;
    height: 25px;
    /* Background color will be inherited from the parent car */
}

.car-wheel {
    width: 12px;
    height: 12px;
    background-color: #333;
    border-radius: 50%;
    position: absolute;
    bottom: 5px;
    z-index: 3;
}

.car-wheel.left-wheel {
    left: 3px;
}

.car-wheel.right-wheel {
    right: 3px;
}


#road {
    height: 5500px;
    background-repeat: repeat-y;
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    animation: scrollRoad 40s linear infinite;
    background-color: #222;
    width: 200px;
    border-left: 5px dashed rgba(255, 255, 255, 0.7);
    border-right: 5px dashed rgba(255, 255, 255, 0.7);
    z-index: 1;
    overflow: hidden;
}

@keyframes scrollRoad {
    0% { transform: translateY(0) translateX(-50%); }
    100% { transform: translateY(-50%) translateX(-50%); }
}

/* Styles for other cars - modified to include internal structure */
.other-car {
    height: 80px;
    width: 40px;
    position: absolute;
    border-left: 2px solid black;
    border-right: 2px solid black;
    border-radius: 5px;
    z-index: 1;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    padding: 5px 0;
    box-sizing: border-box;
}


/* Specific positions for other cars - relative to the road */
/* Specific positions for other cars - relative to the road */
#car1 { background-color: yellow; top: 350px; }
#car2 { background-color: green; top: 400px; }
#car3 { background-color: blue; top: 700px; }
#car4 { background-color: violet; top: 1000px; }
#car5 { background-color: blueviolet; top: 1250px; }
#car6 { background-color: orange; top: 1500px; }
#car7 { background-color: teal; top: 1750px; }
#car8 { background-color: brown; top: 2000px; }
#car9 { background-color: pink; top: 2250px; }
#car10 { background-color: lightblue; top: 2500px; }
#car11 { background-color: lightcoral; top: 2750px; }

#controls2{
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 3;
    display: flex;
    gap: 20px;
}

button{
    opacity: 0.9;
    height: 60px;
    width: 60px;
    font-size: 1.8em;
    border-radius: 10px;
    cursor: pointer;
    background-color: #4CAF50;
    color: white;
    border: none;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
    transition: transform 0.1s ease;
}

button:active {
    transform: scale(0.95);
}

#scoreboard {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    font-family: 'Inter', sans-serif;
    font-size: 1.8em;
    font-weight: bold;
    z-index: 4;
    min-width: 150px;
    text-align: center;
}

/* --- New CSS for the Creative Dialog Box --- */
#gameOverDialog {
    display: none; /* Hidden by default */
    position: absolute;
    top: 0;
    left: 0;
    margin-top: 5cm;
    width: 100%;
    height: 50%;
    z-index: 10;
    display: flex;
    justify-content: center;
    align-items: center;
}

#dialogContent {
    background-color: #fff;
    color: #333;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    max-width: 80%;
    transform: scale(0.8); /* Start slightly smaller */
    opacity: 0; /* Start invisible */
    transition: transform 0.3s ease-out, opacity 0.3s ease-out; /* Animation */
    position: relative; /* For the "X" button positioning */
}

#gameOverDialog.active #dialogContent {
    transform: scale(1); /* Scale to normal size */
    opacity: 1; /* Fade in */
}

#dialogContent h2 {
    margin-top: 0;
    color: #e74c3c; /* Red color for "Game Over" */
    font-size: 2.5em;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
}

#dialogContent p {
    font-size: 1.5em;
    margin-bottom: 25px;
    line-height: 1.4;
}

#finalScore {
    font-size: 1.8em;
    font-weight: bold;
    color: #28a745; /* Green for score */
}

#dialogButtons {
    display: flex;
    justify-content: center;
    gap: 15px;
}

#dialogButtons button {
    height: 50px;
    width: auto; /* Adjust width based on content */
    padding: 0 25px; /* Add horizontal padding */
    font-size: 1.2em;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    transition: background-color 0.2s ease, transform 0.1s ease;
    opacity: 1; /* Override general button opacity */
}

#dialogButtons button:hover {
    transform: translateY(-2px);
}

#playAgainBtn {
    background-color: #007bff; /* Blue for Play Again */
    color: white;
}

#playAgainBtn:hover {
    background-color: #0056b3;
}

#exitBtn {
    background-color: #6c757d; /* Gray for Exit */
    color: white;
}

#exitBtn:hover {
    background-color: #5a6268;
}

/* Close button for the dialog (optional) */
.close-dialog-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 2em;
    color: #aaa;
    cursor: pointer;
    transition: color 0.2s ease;
}

.close-dialog-btn:hover {
    color: #333;
}

</style>
</head>
<body>

<div id="openworld">
    <div id="scoreboard"> Your Score: 0</div>
    <div id="car">
        <div class="car-window"></div>
        <div class="car-body-section"></div>
        <div class="car-window"></div>
        <div class="car-wheel left-wheel"></div>
        <div class="car-wheel right-wheel"></div>
    </div>
    <div id="road">
        <div id="car1" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car2" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car3" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car4" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car5" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car6" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car7" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car8" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car9" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car10" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        <div id="car11" class="other-car">
            <div class="car-window"></div>
            <div class="car-body-section"></div>
            <div class="car-window"></div>
            <div class="car-wheel left-wheel"></div>
            <div class="car-wheel right-wheel"></div>
        </div>
        
    </div>
    <div id="controls2">
        <button onclick="moveleft()">⬅️</button>
        <button onclick="moveright()">➡️</button>
    </div>

    <div id="gameOverDialog">
        <div id="dialogContent">
            <span class="close-dialog-btn" onclick="hideGameOverDialog()">&times;</span>
            <h2>GAME OVER!</h2>
            <p>You crashed!</p>
            <p>Created by SJ Developers</p>
            <p>Your Final Score: <span id="finalScore">0</span></p>
            <div id="dialogButtons">
                <button id="playAgainBtn">Play Again</button>
                <button id="exitBtn">Exit</button>
            </div>
        </div>
    </div>

</div>

<script>
const car = document.getElementById("car");
const road = document.getElementById("road");
const openworld = document.getElementById("openworld");
const scoreboard = document.getElementById("scoreboard");
const gameOverDialog = document.getElementById("gameOverDialog");
const finalScoreSpan = document.getElementById("finalScore");
const playAgainBtn = document.getElementById("playAgainBtn");
const exitBtn = document.getElementById("exitBtn");

let collisionDetected = false;
let score = 0;
let scoreInterval;
let gameInterval;

function showGameOverDialog() {
    gameOverDialog.style.display = 'flex';
    setTimeout(() => gameOverDialog.classList.add('active'), 10); // Small delay for transition
    finalScoreSpan.textContent = score;
}

function hideGameOverDialog() {
    gameOverDialog.classList.remove('active');
    setTimeout(() => {
        gameOverDialog.style.display = 'none';
    }, 300); // Wait for animation to finish
}

playAgainBtn.addEventListener('click', () => {
    location.reload();
});

exitBtn.addEventListener('click', () => {
    alert("Thanks for playing!");
    hideGameOverDialog();
    // In a real web page, you might close the window: window.close();
});

function moveCar(direction) {
    if (collisionDetected) return;

    const carRect = car.getBoundingClientRect();
    const openworldRect = openworld.getBoundingClientRect();
    const roadRect = road.getBoundingClientRect();

    // Calculate road boundaries relative to the openworld
    const roadLeftInOpenworld = (openworldRect.width - roadRect.width) / 2;
    const roadRightInOpenworld = roadLeftInOpenworld + roadRect.width;

    let currentCarLeft = car.offsetLeft;
    const step = 20;

    if (direction === 'left') {
        currentCarLeft -= step;
    } else if (direction === 'right') {
        currentCarLeft += step;
    }

    // Define boundaries for the car's movement
    const minCarLeft = roadLeftInOpenworld;
    const maxCarLeft = roadRightInOpenworld - carRect.width;

    // Clamp the car's position to stay on the road
    currentCarLeft = Math.max(minCarLeft, Math.min(maxCarLeft, currentCarLeft));

    car.style.left = currentCarLeft + "px";
    car.style.transform = 'none'; // Ensure transform doesn't interfere
}

function moveleft(){
    moveCar('left');
}

function moveright(){
    moveCar('right');
}

document.addEventListener('keydown', function(event) {
    if (event.key === 'ArrowLeft') {
        moveCar('left');
    } else if (event.key === 'ArrowRight') {
        moveCar('right');
    }
});

function updateScore() {
    if (!collisionDetected) {
        score += 1;
        scoreboard.textContent = `Score: ${score}`;
    }
}

function checkCollision() {
    if (collisionDetected) return;

    const playerRect = car.getBoundingClientRect();

    document.querySelectorAll('.other-car').forEach(otherCar => {
        const otherRect = otherCar.getBoundingClientRect();

        // Standard AABB collision check
        if (playerRect.left < otherRect.right &&
            playerRect.right > otherRect.left &&
            playerRect.top < otherRect.bottom &&
            playerRect.bottom > otherRect.top) {

            collisionDetected = true;
            clearInterval(gameInterval);
            clearInterval(scoreInterval);
            road.style.animationPlayState = 'paused';
            showGameOverDialog();
        }
    });
}

// --- MODIFIED SECTION ---
window.addEventListener('load', () => {
    const roadRect = road.getBoundingClientRect();
    const carRect = car.getBoundingClientRect();
    const openworldRect = openworld.getBoundingClientRect();

    const roadLeftInOpenworld = (openworldRect.width - roadRect.width) / 2;
    const roadWidth = roadRect.width;
    const carWidth = carRect.width;

    // Player car initial positioning
    car.style.left = (roadLeftInOpenworld + (roadWidth / 2) - (carWidth / 2)) + "px";
    car.style.transform = 'none';

    // --- NEW LOGIC: Define three lanes to prevent car overlap ---
    // We calculate positions for left, center, and right lanes.
    const leftLane = roadLeftInOpenworld + (roadWidth * 0.25) - (carWidth / 2);
    const centerLane = roadLeftInOpenworld + (roadWidth * 0.50) - (carWidth / 2);
    const rightLane = roadLeftInOpenworld + (roadWidth * 0.75) - (carWidth / 2);
    
    // An array containing all possible lane positions
    const lanes = [leftLane, centerLane, rightLane];

    // Position other cars in one of the three defined lanes
    const otherCars = document.querySelectorAll('.other-car');
    otherCars.forEach(otherCar => {
        // Randomly pick one of the available lanes for each car
        const randomLane = lanes[Math.floor(Math.random() * lanes.length)];
        
        otherCar.style.left = randomLane + "px";
        otherCar.style.transform = 'none';
    });

    gameInterval = setInterval(checkCollision, 10);
    scoreInterval = setInterval(updateScore, 100);
});
</script>
</body>
</html>
